/*
Εργαστήριο ΛΣ 2 / Άσκηση 1 / Ερώτημα 1 / 2021-22
Ονοματεπώνυμο: Αθανασίου Βασίλειος Ευάγγελος
ΑΜ: 19390005
*/

Έστω ένα πρόγραμμα σε C στην αρχή του οποίου δίνονται οι εξής εντολές:
1 pid1=fork();
2 if (pid1==0) { pid2=fork(); }
3 else { pid3=fork(); pid4=fork(); }
...............................
a) Πόσες διεργασίες παράχθηκαν με τις προηγούμενες εντολές; 
b) Ποια είναι η «συγγένεια» μεταξύ τους; 
c) Εξηγείστε συνοπτικά πως παρήχθησαν οι ανωτέρω διεργασίες 
   (βήμα/εντολή προς βήμα/εντολή, με ποιο fork δημιουργήθηκε 
   η κάθε μία / ποιο pid αντιστοιχεί σε κάθε μία κλπ). 
d) Δώστε επίσης ένα σχήμα στο οποίο θα φαίνεται με σαφή τρόπο η
ιεραρχία μεταξύ των ανωτέρω διεργασιών.

----------------------------------------------------------------------------
Απάντηση: 

a)  Με τις παραπάνω εντολές δημιουργούνται πέντε νέες διεργασίες. 

b)  Πιο αναλυτικά, είναι η κύρια γονική διεργασία P0, όπου δημιουργεί τρεις 
νέες διεργασίες παιδιά P1, P3 και P4. Οι διεργασίες παιδιά P1 και P3 δημιουργούν,
επίσης, δύο νέες διεργασίες παιδιά P2 και P5 (βλ. υποερώτημα d). 

c)  Η δημιουργία των παραπάνω διεργασιών (P1, P2, P3, P4, P5) επιτυγχάνεται με την 
χρήση της συνάρτησης "fork ()" που εισάγεται από την βιβλιοθήκη <unistd.h>. Διεξοδικά, 
η γονική διεργασία P0 δημιουργεί με την εντολή "pid1 = fork ();" μία διεργασία παιδί 
την P1. Η "fork ()" επιστρέφει την τιμή 0 στη νέα διεργασία που δημιούργησε (διεργασία παιδί) και 
επιστρέφει στη γονική διεργασία μία ακέραια θετική τιμή, δηλαδή, το "id" της διεργασίας
παιδί που δημιούργησε ή την τιμή -1, εφόσον, προέκυψε κάποιο σφάλμα κατά την εκτέλεση της 
"fork ()", συνεπώς, στη δημιουργία της διεργασίας παιδί. Η μεταβλητή "pid1" περιέχει είτε 
την τιμή 0 και αντιστοιχεί στην διεργασία παιδί P1 της γονικής διεργασίας P0, είτε μία 
θετική ακέραια τιμή που είναι το "id" της P1 και αντιστοιχεί στην P0 (γραμμή 1, pid1 = fork ();).
    Στη συνέχεια, πραγματοποιείται ένας έλεγχος με την εντολή "if-else" για το περιεχόμενο της μεταβλητής 
"pid1". Συγκεκριμένα, εφόσον, περιέχει την τιμή 0, δηλαδή, εκτελείται η διεργασία παιδί P1 της γονικής 
διεργασίας P0, τότε θα εκτελεστούν οι εντολές της "if", δηλαδή, η εντολή "pid2 = fork ()". Η 
"fork ()" δημιουργεί μία νέα διεργασία παιδί P2 της γονικής διεργασίας P1. Επομένως, η  μεταβλητή
"pid2" περιέχει είτε την τιμή 0 και αντιστοιχεί στην διεργασία παιδί P2 της γονικής διεργασίας P1,
είτε μία θετική ακέραια τιμή που είναι το "id" της P2 και αντιστοιχεί στην P1 (γραμμή 2, if (pid1 == 0)
{ pid2 = fork (); }).
    Αντίθετα, εάν, η μεταβλητή "pid1" δεν περιέχει την τιμή 0, δηλαδή, περιέχει το "id" της διεργασίας παιδί P1 της 
γονικής διεργασίας P0, τότε θα εκτελεστούν οι εντολές της "else", δηλαδή, οι εντολές "pid3 = fork ();"
και "pid4 = fork ();". Διεξοδικά, δημιουργούνται με την κάθε "fork ()" δύο νέες διεργασίες παιδιά P3, 
P4 της γονικής διεργασίας P0. Αξίζει να σημειωθεί ότι η διεργασία P3 δημιουργεί, επίσης, μία διεργασία 
παιδί P5. Αυτό δικαιολογείται με την προϋπόθεση ότι η μεταβλητή "pid3" περιέχει την τιμή 0 που αντιστοιχεί
στην διεργασία παιδί P3 της γονικής διεργασίας P0 και επομένως, θα εκτελεστεί η αμέσως επόμενη εντολή που 
είναι η "pid4 = fork ();´", με αποτέλεσμα να δημιουργείται μία νέα διεργασία παιδί P5 της γονικής διεργασίας 
P3. Εάν, η μεταβλητή "pid3" περιέχει μία θετική ακέραια τιμή, τότε, πρόκειται για το "id" της διεργασίας 
παιδί P3 της γονικής διεργασίας P0 και συνεπώς, η μεταβλητή αντιστοιχεί στην P0. Τέλος, εφόσον, η "pid3" 
αντιστοιχεί στην διεργασία P0, δηλαδή, περιέχει μια θετική ακέραια τιμή που είναι το "id" της διεργασίας 
παιδί P3, τότε, η "pid4" αντιστοιχεί, εφόσον, περιέχει την τιμή 0 στην διεργασία παιδί P4 της γονικής 
διεργασίας P0, διαφορετικά, αν περιέχει μία ακέραια θετική τιμή, τότε πρόκειται για το "id" της διεργασίας 
παίδι P4 της γονικής διεργασίας P0 και επομένως, αντιστοιχεί στην P0. Αντίθετα, εφόσον, η "pid3" αντιστοιχεί
στην διεργασία P3, δηλαδή, περιέχει την τιμή 0, τότε, η "pid4" αντιστοιχεί, εφόσον, περιέχει την τιμή 0 στην
διεργασία παιδί P5 της γονικής διεργασίας P3. Διαφορετικά, αν περιέχει μία θετική ακέραια τιμή, που είναι το 
"id" της διεργασίας παιδί P5 της γονικής διεργασίας P3, τότε η "pid4" αντιστοιχεί στην P3 (γραμμή 3, else 
{ pid3=fork(); pid4=fork(); }).


d)                         (P0)
                            /|\
                           / | \
                          /  |  \
                         /   |   \ 
                        /    |    \
                     (P1)  (P3)  (P4)
                      /      |
                     /       |
                    /        |
                   /         |
                (P2)       (P5)
                                            
                        
                            
                                    
                                    
                                             

